[gcode_macro heat_soak]
gcode:
    {% set TEMP = params.TEMP|default(45)|float %} #chamber temp (C)

    {% if not printer["temperature_sensor chamber"].temperature >= TEMP %}
    M117 Heat soaking started
    {action_respond_info('Heat soaking started')}
    G28
    G1 X150 Y150 F5000
    M190 S110 
    TEMPERATURE_WAIT SENSOR=heater_bed MAXIMUM=110
    SET_FAN_SPEED FAN=nevermore SPEED=1
    M106 S255
    {% else %}
    { action_respond_info("Chamber at or above temp.") }
    M117 Chamber at or above temp.
    {% endif %}